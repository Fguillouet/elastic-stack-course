#Extinction des conteneurs
docker-compose down 
docker ps
docker system prune 

#Installation de Java
sudo apt install default-jre

#Installation d'elasticsearch
sudo su -
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
sudo apt-get install apt-transport-https
echo "deb https://artifacts.elastic.co/packages/7.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-7.x.list
sudo apt-get update && sudo apt-get install elasticsearch

#Activer et démarer le service elasticsearch + vérification du status
systemctl status elasticsearch
systemctl enable elasticsearch
systemctl start elasticsearch
systemctl status elasticsearch

# vérifier si cela fonctionne
curl localhost:9200

#installation de Kibana
sudo apt-get install kibana
#Activer et démarer le service Kibana + vérification du status
systemctl status kibana
systemctl enable kibana
systemctl start kibana
systemctl status kibana


#Modification
nano /etc/kibana/kibana.yml
    server.host : "0.0.0.0"
systemctl restart kibana
exit

#Logstash et filebeat
cd ~/elastic-stack-course/
sudo apt install logstash
sudo apt install filebeat

#Configuration de Logstash (si besoin)
cd /etc/logstash
nano logstash.yml

#Configuration de filebeat
    #si besoin d'aller plus loins dans la configuration
    cd /etc/filebeat
    sudo nano filebeat.yml

filebeat module enable system 
filebeat setup
systemctl start filebeat 
systemctl status filebeat 
systemctl enable filebeat 

#Un nouvel indice est alors créé on peut le vérifier dans les dev tools de kibhana -> GET _cat/indices
